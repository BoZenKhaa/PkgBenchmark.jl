<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Defining a benchmark suite · PkgBenchmark.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/highlightjs/default.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>PkgBenchmark.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li class="current"><a class="toctext" href="define_benchmarks.html">Defining a benchmark suite</a><ul class="internal"><li><a class="toctext" href="#Conventions-1">Conventions</a></li><li><a class="toctext" href="#Writing-benchmarks-1">Writing benchmarks</a></li></ul></li><li><a class="toctext" href="run_benchmarks.html">Running a benchmark suite</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="define_benchmarks.html">Defining a benchmark suite</a></li></ul><a class="edit-page" href="https://github.com/JuliaCI/PkgBenchmark.jl/tree/0e6366992fb4e09128f78d6e3b231b3b9833d751/docs/src/man/define_benchmarks.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Defining a benchmark suite</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Defining-a-benchmark-suite-1" href="#Defining-a-benchmark-suite-1">Defining a benchmark suite</a></h1><h2><a class="nav-anchor" id="Conventions-1" href="#Conventions-1">Conventions</a></h2><ul><li><p>Benchmarks are to be written in <code>&lt;PKGROOT&gt;/benchmark/benchmarks.jl</code> and must use the <code>@benchgroup</code> and <code>@bench</code> macros. These are analogous to <code>@testset</code> and <code>@test</code> macros, with slightly different syntax.</p></li><li><p><code>&lt;PKGROOT&gt;/benchmark/REQUIRE</code> can contain dependencies needed to run the benchmark suite.</p></li></ul><h2><a class="nav-anchor" id="Writing-benchmarks-1" href="#Writing-benchmarks-1">Writing benchmarks</a></h2><h3><a class="nav-anchor" id="@benchgroup-1" href="#@benchgroup-1"><code>@benchgroup</code></a></h3><p><code>@benchgroup</code> defines a benchmark group. It can contain nested <code>@benchgroup</code> and <code>@bench</code> expressions.</p><p><strong>Syntax:</strong></p><pre><code class="language-julia">@benchgroup &lt;name&gt; [&lt;tags&gt;] begin
  &lt;expr&gt;
end</code></pre><p><code>&lt;name&gt;</code> is a string naming the benchmark group. <code>&lt;tags&gt;</code> is a vector of strings, tags for the benchmark group, and is optional. <code>&lt;expr&gt;</code> are expressions that can contain <code>@benchgroup</code> or <code>@bench</code> calls.</p><h3><a class="nav-anchor" id="@bench-1" href="#@bench-1"><code>@bench</code></a></h3><p><code>@bench</code> creates a benchmark under the current <code>@benchgroup</code>.</p><p><strong>Syntax:</strong></p><pre><code class="language-julia">@bench &lt;name&gt;... &lt;expr&gt;</code></pre><p><code>&lt;name&gt;</code> is a name/id for the benchmark, the last argument to <code>@bench</code>, <code>&lt;expr&gt;</code>, is the expression to be benchmarked, and has the same <a href="https://github.com/JuliaCI/BenchmarkTools.jl/blob/master/doc/manual.md#interpolating-values-into-benchmark-expressions">interpolation features</a> as the <code>@benchmarkable</code> macro from BenchmarkTools.</p><h3><a class="nav-anchor" id="Example-1" href="#Example-1">Example</a></h3><p>An example <code>benchmark/benchmarks.jl</code> script would look like:</p><pre><code class="language-julia">using PkgBenchmark

@benchgroup &quot;utf8&quot; [&quot;string&quot;, &quot;unicode&quot;] begin
    teststr = UTF8String(join(rand(MersenneTwister(1), &#39;a&#39;:&#39;d&#39;, 10^4)))
    @bench &quot;replace&quot; replace($teststr, &quot;a&quot;, &quot;b&quot;)
    @bench &quot;join&quot; join($teststr, $teststr)
end

@benchgroup &quot;trigonometry&quot; [&quot;math&quot;, &quot;triangles&quot;] begin
    # nested groups
    @benchgroup &quot;circular&quot; begin
        for f in (sin, cos, tan)
            for x in (0.0, pi)
                
                @bench string(f), x $(f)($x)
            end
        end
    end

    @benchgroup &quot;hyperbolic&quot; begin
        for f in (sinh, cosh, tanh)
            for x in (0.0, pi)
                @bench string(f), x $(f)($x)
            end
        end
    end
end
</code></pre><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Running this script directly does not actually run the benchmarks. See the next section.</p></div></div><footer><hr/><a class="previous" href="../index.html"><span class="direction">Previous</span><span class="title">Home</span></a><a class="next" href="run_benchmarks.html"><span class="direction">Next</span><span class="title">Running a benchmark suite</span></a></footer></article></body></html>
